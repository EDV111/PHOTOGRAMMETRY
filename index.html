<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Model Viewer</title>
    <style>
        #loading-bar {
            height: 10px;
            background-color: #eee;
            margin-top: 10px;
            width: 100%;
            position: relative;
        }

        #loading {
            height: 100%;
            background-color: #4CAF50;
            position: absolute;
            width: 0%;
            top: 0;
            left: 0;
            transition: width 0.3s ease-in-out;
        }

        #loading-text {
            margin-top: 5px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
        }

        #cesiumContainer {
            width: 100%;
            height: 600px;
        }
    </style>
</head>
<body>
    <div id="cesiumContainer"></div>
    <div id="loading-bar">
        <div id="loading"></div>
    </div>
    <div id="loading-text"></div>

    <script src="https://cesium.com/downloads/cesiumjs/releases/1.83/Build/Cesium/Cesium.js"></script>
    <script>
        const viewer = new Cesium.Viewer('cesiumContainer');

        const progressBar = document.getElementById('loading');
        const loadingText = document.getElementById('loading-text');

        // Disable the default event handlers
        viewer.extend(Cesium.viewerDragDropMixin);

        viewer._dragDrop.viewModel.dropZone.addEventListener('drop', function (event) {
            event.preventDefault();
            event.stopPropagation();

            const files = event.dataTransfer.files;
            const file = files[0];
            const fileSize = file.size / (1024 * 1024); // MB

            if (fileSize > 50) {
                alert('File is too large! Maximum file size is 50 MB.');
                return;
            }

            // Update the loading bar
            progressBar.style.width = '0%';
            loadingText.innerHTML = 'Loading...';

            const fileUrl = URL.createObjectURL(file);

            // Load the model
            const model = viewer.scene.primitives.add(Cesium.Model.fromGltf({
                url: fileUrl,
                maximumScale: 20000
            }));

            // Zoom to the model
            viewer.zoomTo(model);

            // Update the loading bar on progress
            model.readyPromise.then(function () {
                loadingText.innerHTML = '';
                progressBar.style.width = '100%';
                setTimeout(function () {
                    progressBar.style.width = '0%';
                }, 1000);
            }).otherwise(function (error) {
                loadingText.innerHTML = '';
                alert('Error: ' + error);
            });
        });
    </script>
</body>
</html>


