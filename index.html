<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>3D Viewer</title>
	<script src="https://cesium.com/downloads/cesiumjs/releases/1.87/Build/Cesium/Cesium.js"></script>
	<link href="https://cesium.com/downloads/cesiumjs/releases/1.87/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
	<style>
		#cesiumContainer {
			width: 100%;
			height: 100%;
			position: absolute;
		}

		#dropBox {
			border: 3px dashed grey;
			width: 100%;
			height: 200px;
			display: flex;
			justify-content: center;
			align-items: center;
			flex-direction: column;
			font-size: 30px;
			font-weight: bold;
			color: grey;
		}

		#loadingBar {
			position: absolute;
			bottom: 0;
			width: 100%;
			height: 5px;
			background-color: #ddd;
			display: none;
		}

		#loadingBar .fill {
			height: 100%;
			background-color: #4CAF50;
			width: 0%;
			transition: width 0.3s ease-in-out;
		}

		#modelViewer {
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			background-color: #222;
		}
	</style>
</head>
<body>
	<div id="cesiumContainer"></div>
	<div id="dropBox">
		Drop a GLB file here to view in 3D!
	</div>
	<div id="loadingBar">
		<div class="fill"></div>
	</div>
	<div id="modelViewer"></div>
	<script>
		const viewer = new Cesium.Viewer('cesiumContainer', {
			shouldAnimate: true
		});

		const dropBox = document.getElementById('dropBox');
		const loadingBar = document.getElementById('loadingBar');
		const loadingBarFill = document.querySelector('#loadingBar .fill');
		const modelViewer = document.getElementById('modelViewer');
		const fileInput = document.createElement('input');
		fileInput.type = 'file';
		fileInput.style.display = 'none';
		document.body.appendChild(fileInput);

		function showModel(url) {
			loadingBar.style.display = 'block';

			// Load the model
			const model = viewer.scene.primitives.add(Cesium.Model.fromGltf({
				url: url,
				maximumScale: 20000
			}));

			// Zoom to the model
			viewer.zoomTo(model);

			// Hide the loading bar when the model is done loading
			model.readyPromise.then(() => {
				loadingBar.style.display = 'none';
				modelViewer.style.display = 'block';
			});
		}

		function handleFileSelect(event) {
			event.stopPropagation();
			event.preventDefault();
			const file = event.dataTransfer.files[0] || event.target.files[0];
			const fileSize = file.size / (1024 * 1024);
			if (file.type === 'model/gltf+json' || file.type === 'model/gltf-binary' || file.type === 'model/vnd.gltf+json' || file.name.toLowerCase().endsWith('.glb') || file.name.toLowerCase().endsWith('.gltf') ) {
				if (fileSize > 26) {
					alert('Please
        function handleDrop(e) {
            const dt = e.dataTransfer
            const files = dt.files

            handleFiles(files)
        }

        function handleFiles(files) {
            const file = files[0]
            const reader = new FileReader()

            reader.readAsDataURL(file)
            reader.onloadstart = () => {
                loadingBar.style.width = "0%"
                loadingBar.style.display = "block"
            }

            reader.onprogress = (event) => {
                const progress = Math.round((event.loaded / event.total) * 100)
                loadingBar.style.width = `${progress}%`
            }

            reader.onload = (event) => {
                const fileUrl = event.target.result

                const model = viewer.scene.primitives.add(Cesium.Model.fromGltf({
                    url: fileUrl,
                    maximumScale: 20000
                }));

                viewer.zoomTo(model)

                const modelInfo = document.createElement('div')
                modelInfo.innerHTML = `
                    <h2>${file.name}</h2>
                    <ul>
                        <li>Number of nodes: ${model.nodes.length}</li>
                        <li>Number of meshes: ${model.meshes.length}</li>
                        <li>Number of materials: ${model.materials.length}</li>
                    </ul>
                `

                const container = document.getElementById("container")
                container.appendChild(modelInfo)

                loadingBar.style.width = "100%"
                setTimeout(() => {
                    loadingBar.style.display = "none"
                }, 500)
            }

            reader.onerror = () => {
                console.error('Error reading file')
            }
        }
    </script>
</body>
</html>



